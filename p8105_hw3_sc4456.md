p8105\_hw3\_sc4456
================
Siyan Chen
10/5/2018

Problem 1
=========

data import

``` r
devtools::install_github("p8105/p8105.datasets")
```

    ## Skipping install of 'p8105.datasets' from a github remote, the SHA1 (21f5ad1c) has not changed since last install.
    ##   Use `force = TRUE` to force installation

``` r
library(p8105.datasets)
data(brfss_smart2010) 
modified_brfss = 
  brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  mutate(response =factor(response, levels = c("Excellent", "Very good", "Good", "Fair", "Poor"))) %>% 
 arrange(response)
```

### 1

``` r
modified_brfss %>% 
  filter(year == "2002") %>% 
  group_by(locationabbr, locationdesc) %>% 
  summarise(number = n()) %>% 
  group_by(locationabbr) %>% 
  summarise(number= n()) %>% 
  filter(number == "7") 
```

    ## # A tibble: 3 x 2
    ##   locationabbr number
    ##   <chr>         <int>
    ## 1 CT                7
    ## 2 FL                7
    ## 3 NC                7

-   In 2002, state CT, FL, NC were observed at 7 locations. \#\#\#2

``` r
modified_brfss %>% 
  group_by(year, locationabbr) %>% 
  summarise(number = n()) %>% 
  ggplot(aes(x = year, y = number, color = locationabbr)) + geom_line()
```

![](p8105_hw3_sc4456_files/figure-markdown_github/unnamed-chunk-3-1.png) \#\#\#3

``` r
modified_brfss %>% 
  filter(locationabbr == "NY") %>% 
  filter(year == "2002" | year == "2006" | year == "2010") %>%
  select(year, locationdesc, response, sample_size) %>% 
  spread(key = response, value = sample_size) %>% 
  janitor::clean_names() %>% 
  mutate(excellent_proption = excellent / (excellent + very_good + good + fair + poor)) %>% select(year, locationdesc, excellent_proption) %>% 
  group_by(year) %>% 
  summarise(mean = mean(excellent_proption), sd = sd(excellent_proption))
```

    ## # A tibble: 3 x 3
    ##    year  mean     sd
    ##   <int> <dbl>  <dbl>
    ## 1  2002 0.248 0.0398
    ## 2  2006 0.218 0.0387
    ## 3  2010 0.203 0.0460

### 4

``` r
tidy_response_data =
modified_brfss %>% 
select(year, locationabbr, locationdesc, response, sample_size) %>% 
 spread(key = response, value = sample_size) %>% 
  janitor::clean_names() %>% 
  mutate(excellent = excellent / (excellent + very_good + good + fair + poor), 
         very_good = very_good / (excellent + very_good + good + fair + poor), 
         good = good / (excellent + very_good + good + fair + poor),
         fair = fair / (excellent + very_good + good + fair + poor),
         poor = poor / (excellent + very_good + good + fair + poor)
         ) %>% 
# replace with proportion of response category
  group_by(year, locationabbr) %>% 
  summarise(mean_excellent_proportion = mean(excellent), 
            mean_very_good_proportion = mean(very_good),
            mean_good_proportion = mean(good), 
            mean_fair_proportion = mean(fair), 
            mean_poor_proportion = mean(poor))  
  head(tidy_response_data)
```

    ## # A tibble: 6 x 7
    ## # Groups:   year [1]
    ##    year locationabbr mean_excellent_… mean_very_good_… mean_good_propo…
    ##   <int> <chr>                   <dbl>            <dbl>            <dbl>
    ## 1  2002 AK                      0.279            0.456            0.635
    ## 2  2002 AL                      0.187            0.355            0.646
    ## 3  2002 AR                      0.237            0.357            0.620
    ## 4  2002 AZ                      0.238            0.439            0.680
    ## 5  2002 CA                      0.250            0.430            0.623
    ## 6  2002 CO                      0.227            0.446            0.680
    ## # ... with 2 more variables: mean_fair_proportion <dbl>,
    ## #   mean_poor_proportion <dbl>

``` r
  Excellent_plot = ggplot(tidy_response_data, aes(x = year, y = mean_excellent_proportion, color = locationabbr)) + geom_line()
```
